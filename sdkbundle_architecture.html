<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="keywords" content=" ">
<title>Architecture | Matterport Developers</title>
<link rel="stylesheet" href="css/syntax.css">

<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="css/modern-business.css">
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<link rel="stylesheet" href="css/customstyles.css">
<link rel="stylesheet" href="css/boxshadowproperties.css">
<!-- most color styles are extracted out to here -->
<link rel="stylesheet" href="css/theme-matterport.css">
<link href="https://fonts.googleapis.com/css?family=Roboto:400,700&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans:400,700&display=swap" rel="stylesheet">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="js/jquery.navgoco.min.js"></script>


<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<!-- Anchor.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.0/anchor.min.js"></script>
<script src="js/toc.js"></script>
<script src="js/customscripts.js"></script>
<script src="js/mermaid.min.js"></script>

<link rel="shortcut icon" href="images/favicon.ico">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link rel="alternate" type="application/rss+xml" title="showcase-sdk" href="https://matterport.github.io/feed.xml">

    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    <script>
        $(document).ready(function() {
            $("#tg-sb-link").click(function() {
                $("#tg-sb-sidebar").toggle();
                $("#tg-sb-content").toggleClass('col-md-9');
                $("#tg-sb-content").toggleClass('col-md-12');
                $("#tg-sb-icon").toggleClass('fa-toggle-on');
                $("#tg-sb-icon").toggleClass('fa-toggle-off');
            });
        });
    </script>
    
    
</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-static-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-home fa-lg navbar-brand" href="index.html">&nbsp;<img class="navbar-image" src="images/MP-logo_H_lock-RGB_white.svg"></img><span class="projectTitle"> </span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- toggle sidebar button -->
                <li><a id="tg-sb-link" href="#"><i id="tg-sb-icon" class="fa fa-toggle-on"></i> Nav</a></li>
                <!-- entries without drop-downs appear here -->




                
                
                
                <li><a href="sdk_home.html">SDK for Embeds</a></li>
                
                
                
                <li><a href="sdkbundle_home.html">SDK Bundle</a></li>
                
                
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                
			<li>



  <a class="email" title="Submit feedback" href="#" onclick="javascript:window.location='mailto:developer@matterport.com?subject=Showcase SDK feedback&body=I have some feedback about the Architecture page: ' + window.location.href;"><i class="fa fa-envelope-o"></i> Feedback</a>

</li>

		
                <!--comment out this block if you want to hide search-->
                <li>
                    <!--start search-->
                    <div id="search-demo-container">
                        <input type="text" id="search-input" placeholder="search...">
                        <ul id="results-container"></ul>
                    </div>
                    <script src="js/jekyll-search.js" type="text/javascript"></script>
                    <script type="text/javascript">
                            SimpleJekyllSearch.init({
                                searchInput: document.getElementById('search-input'),
                                resultsContainer: document.getElementById('results-container'),
                                dataSource: 'search.json',
                                searchResultTemplate: '<li><a href="{url}" title="Architecture">{title}</a></li>',
                    noResultsText: 'No results found.',
                            limit: 10,
                            fuzzy: true,
                    })
                    </script>
                    <!--end search-->
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>

<div class='global-links-container'>
  <a
    class='global-link'
    href="https://matterport.com/legal/sdk-api-agreement"
    target="_blank"
    rel="noopener"
  >SDK Agreement
  </a>
</div>
<!-- Page Content -->
<div class="container">
  <div id="main">
    <!-- Content Row -->
    <div class="row">
        
        
            <!-- Sidebar Column -->
            <div class="col-md-3" id="tg-sb-sidebar">
                

<ul id="mysidebar" class="nav">
  <li class="sidebarTitle">SDK Bundle </li>
  
  
  
  <li>
      <a title="Overview" href="#">Overview</a>
      <ul>
          
          
          
          <li><a title="Home" href="sdkbundle_home.html">Home</a></li>
          
          
          
          
          
          
          <li><a title="Early Access" href="earlyaccess_home.html">Early Access</a></li>
          
          
          
          
          
          
          <li class="active"><a title="Architecture" href="sdkbundle_architecture.html">Architecture</a></li>
          
          
          
          
          
          
          <li><a title="Installation" href="sdkbundle_installation.html">Installation</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a title="Tutorials" href="#">Tutorials</a>
      <ul>
          
          
          
          <li><a title="Setup" href="sdkbundle_tutorials_setup.html">Setup</a></li>
          
          
          
          
          
          
          <li><a title="Working with models" href="sdkbundle_tutorials_models.html">Working with models</a></li>
          
          
          
          
          
          
          <li><a title="Setting up Embedly" href="sdkbundle_tutorials_setting_up_embedly.html">Setting up Embedly</a></li>
          
          
          
          
          
          
          <li><a title="Using xr" href="sdkbundle_tutorials_using_xr.html">Using xr</a></li>
          
          
          
          
          
          
          <li><a title="Using scene objects" href="sdkbundle_tutorials_using_scene_objects.html">Using scene objects</a></li>
          
          
          
          
          
          
          <li><a title="Using OAuth" href="sdkbundle_tutorials_using_oauth.html">Using OAuth</a></li>
          
          
          
          
          
          
          <li><a title="Using Pathfinding" href="sdkbundle_pathfinding.html">Using Pathfinding</a></li>
          
          
          
          
          
          
          <li><a title="Controlling the Pointer Reticle" href="sdkbundle_cursor.html">Controlling the Pointer Reticle</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a title="Examples" href="#">Examples</a>
      <ul>
          
          
          
          <li><a title="Summary" href="sdkbundle_examples_summary.html">Summary</a></li>
          
          
          
          
          
          
          <li><a title="Virtual Staging" href="sdkbundle_virtual_staging.html">Virtual Staging</a></li>
          
          
          
          
          
          
          <li><a title="Local Webcam" href="sdkbundle_local_webcam.html">Local Webcam</a></li>
          
          
          
          
          
          
          <li><a title="HTML Livestream" href="sdkbundle_html_livestream.html">HTML Livestream</a></li>
          
          
          
          
          
          
          <li><a title="IoT Canvas" href="sdkbundle_iot_canvas.html">IoT Canvas</a></li>
          
          
          
          
          
          
          <li><a title="Custom Experience" href="sdkbundle_custom_experience.html">Custom Experience</a></li>
          
          
          
          
          
          
          <li><a title="Security Camera FOV" href="sdkbundle_security_camera.html">Security Camera FOV</a></li>
          
          
          
          
          
          
          <li><a title="Content Attribution" href="sdkbundle_content_attribution.html">Content Attribution</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a title="Reference" href="#">Reference</a>
      <ul>
          
          
          
          <li><a title="Summary" href="sdkbundle_reference.html">Summary</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a title="Components" href="#">Components</a>
      <ul>
          
          
          
          <li><a title="Ambient Light" href="sdkbundle_components_ambientlight.html">Ambient Light</a></li>
          
          
          
          
          
          
          <li><a title="Directional Light" href="sdkbundle_components_directionallight.html">Directional Light</a></li>
          
          
          
          
          
          
          <li><a title="Point Light" href="sdkbundle_components_pointlight.html">Point Light</a></li>
          
          
          
          
          
          
          <li><a title="GLTF Loader" href="sdkbundle_components_gltfloader.html">GLTF Loader</a></li>
          
          
          
          
          
          
          <li><a title="DAE Loader" href="sdkbundle_components_daeloader.html">DAE Loader</a></li>
          
          
          
          
          
          
          <li><a title="FBX Loader" href="sdkbundle_components_fbxloader.html">FBX Loader</a></li>
          
          
          
          
          
          
          <li><a title="OBJ Loader" href="sdkbundle_components_objloader.html">OBJ Loader</a></li>
          
          
          
          
          
          
          <li><a title="Transform Controls" href="sdkbundle_components_transformcontrols.html">Transform Controls</a></li>
          
          
          
          
          
          
          <li><a title="Input" href="sdkbundle_components_input.html">Input</a></li>
          
          
          
          
          
          
          <li><a title="Camera" href="sdkbundle_components_camera.html">Camera</a></li>
          
          
          
          
          
          
          <li><a title="XR" href="sdkbundle_components_xr.html">XR</a></li>
          
          
          
          
      </ul>
   </li>
     
      
      
      <!-- if you aren't using the accordion, uncomment this block:
         <p class="external">
             <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
         </p>
         -->
</ul>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>

            </div>
            
        

        <!-- Content Column -->
        <div class="col-md-9" id="tg-sb-content">
            <div class="post-header">
   <h1 class="post-title-main">Architecture</h1>
</div>



<div class="post-content">

   

    
    
<!-- this handles the automatic toc. use ## for subheads to auto-generate the on-page minitoc. if you use html tags, you must supply an ID for the heading element in order for it to appear in the minitoc. -->
<script>
$( document ).ready(function() {
  // Handler for .ready() called.

$('#toc').toc({ minimumHeaders: 0, listType: 'ul', showSpeed: 0, headers: 'h2,h3,h4' });

/* this offset helps account for the space taken up by the floating toolbar. */
$('#toc').on('click', 'a', function() {
  var target = $(this.getAttribute('href'))
    , scroll_target = target.offset().top

  $(window).scrollTop(scroll_target - 10);
  return false
})
  
});
</script>

<div id="toc"></div>

    


    

   <h2 id="scene-objects">Scene Objects</h2>

<p>Scene objects aggregate nodes and are the central place where nodes are created, and data and events between components is connected and managed.</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Create a scene object. `createObjects` can create multiple objects and returns an array with that number of objects</span>
<span class="kd">const</span> <span class="p">[</span><span class="nx">sceneObject</span><span class="p">]</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">sdk</span><span class="p">.</span><span class="nx">Scene</span><span class="p">.</span><span class="nx">createObjects</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>

<span class="c1">// Create a scene node</span>
<span class="kd">const</span> <span class="nx">node</span> <span class="o">=</span> <span class="nx">sceneObject</span><span class="p">.</span><span class="nx">addNode</span><span class="p">(</span><span class="s1">'my-node'</span><span class="p">);</span>

<span class="c1">// Adding a component to 'my-node'</span>
<span class="nx">node</span><span class="p">.</span><span class="nx">addComponent</span><span class="p">(</span><span class="s1">'mp.fbx'</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">url</span><span class="p">:</span> <span class="s1">'https://www.google.com'</span><span class="p">,</span>
<span class="p">});</span>

<span class="c1">// Start 'my-node'</span>
<span class="nx">node</span><span class="p">.</span><span class="nx">start</span><span class="p">();</span>
</code></pre></div></div>

<h2 id="scene-nodes">Scene Nodes</h2>

<p>Scene nodes contain and manage the lifecycle of their child components. Scene nodes have a 3D transform that parent child components.</p>

<p>Scene node have the following states:</p>
<ul>
  <li><b>Initializing</b> - The scene node is not part of the scene graph during this state. Components can be added and property bindings can be created.</li>
  <li><b>Operating</b> - The scene node becomes active and is part of the scene graph. Child components are also operating.</li>
  <li><b>Destroyed</b> - The scene node and its components are removed from the scene graph and destroyed.</li>
</ul>

<div class="mermaid">
graph LR&#10;
  id1[createNode] --&gt; Initializing&#10;
  Initializing --&gt; |start| Operating&#10;
  Operating --&gt; |stop| Destroyed&#10;
  style id1 fill-opacity:0.1,stroke-width:0px&#10;
</div>
<p><br /></p>

<p>The following is an example of scene node usage.</p>
<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Creating a scene node</span>
<span class="kd">const</span> <span class="nx">node</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">sdk</span><span class="p">.</span><span class="nx">Scene</span><span class="p">.</span><span class="nx">createNode</span><span class="p">();</span>

<span class="c1">// Adding a component</span>
<span class="nx">node</span><span class="p">.</span><span class="nx">addComponent</span><span class="p">(</span><span class="s1">'mp.fbx'</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">url</span><span class="p">:</span> <span class="s1">'https://www.google.com'</span>
<span class="p">});</span>

<span class="c1">// Starting a scene node</span>
<span class="nx">node</span><span class="p">.</span><span class="nx">start</span><span class="p">();</span>

<span class="c1">// Destroying a scene node</span>
<span class="nx">node</span><span class="p">.</span><span class="nx">stop</span><span class="p">();</span>
</code></pre></div></div>

<h2 id="components">Components</h2>

<p>Components are associated to a single scene node. They are used to build appearance, behavior, and events in 3D.
Components adhere to a standard interface making them reusable and shareable across multiple applications.</p>

<h3 id="component-lifecycle">Component Lifecycle</h3>

<p>Components have five callbacks,</p>

<ul>
  <li><b>onInit</b> - This function is called when the scene node is started. Peer components are called in the order they were added to the scene node.</li>
  <li><b>onEvent</b> - This function is called once for each event that occured during the last frame.</li>
  <li><b>onInputsChanged</b> - This function is called prior to <code class="highlighter-rouge">onTick</code> but after <code class="highlighter-rouge">onEvent</code>. It is called once if any <code class="highlighter-rouge">inputs</code> property has changed during the last frame.</li>
  <li><b>onTick</b> - This function is called every frame.</li>
  <li><b>onDestroyed</b> - This function is called when the scene node is stopped. Component <code class="highlighter-rouge">onDestroy</code> callbacks are called in the reverse order they are added to the scene node.</li>
</ul>

<p>During the <code class="highlighter-rouge">Initializing</code> state, components can be added and property bindings can be created. Calling <code class="highlighter-rouge">start</code> triggers <code class="highlighter-rouge">onInit</code> to be called on each component prior to entering the <code class="highlighter-rouge">Operating</code> state.</p>
<div class="mermaid">
graph LR&#10;
  subgraph Initializing&#10;
    id1(addComponent) --&gt; id2[setupBindings]&#10;
    id2 --&gt; id3&#10;
    id3(start) --&gt; id4[onInit]&#10;
    style id1 fill-opacity:0.1,stroke-width:0px&#10;
    style id3 fill-opacity:0.1,stroke-width:0px&#10;
    style id2 stroke-dasharray: 5, 5&#10;
    style id4 fill:#CEFFD7&#10;
    linkStyle 1 stroke-width:0px&#10;
  end&#10;
</div>
<p><br /></p>

<p>During the <code class="highlighter-rouge">Operating</code> state, events, input changes and ticks are handled by each component.</p>
<div class="mermaid">
graph LR&#10;
  subgraph Operating&#10;
    id1[onEvent] --&gt; id2[onInputsChanged]&#10;
    id1 --queued event--&gt; id1
    id2 --&gt; id3[onTick]&#10;
    style id1 fill:#CEFFD7&#10;
    style id2 fill:#CEFFD7&#10;
    style id3 fill:#CEFFD7&#10;
  end&#10;
</div>
<p><br /></p>

<p>Upon entering the <code class="highlighter-rouge">Destroyed</code> state, components should free allocated resources.</p>
<div class="mermaid">
graph LR&#10;
  subgraph Destroyed&#10;
    id1[stop] --&gt; id2[onDestroyed]&#10;
    style id1 fill-opacity:0.1,stroke-width:0px&#10;
    style id2 fill:#CEFFD7&#10;
  end&#10;
</div>

<h3 id="input-and-output-dictionaries">Input and Output Dictionaries</h3>

<p>Components have properties named <code class="highlighter-rouge">inputs</code> and <code class="highlighter-rouge">outputs</code>. These properties are dictionaries defined by the component. The <code class="highlighter-rouge">inputs</code> dictionary represents properties that affect the components behavior or appearance. The <code class="highlighter-rouge">outputs</code> dictionary represents properties computed by the component.</p>

<p>An example of a computed output,</p>
<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">Sum</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">inputs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">augend</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="na">addend</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="p">};</span>

  <span class="k">this</span><span class="p">.</span><span class="nx">outputs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">sum</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="p">};</span>

  <span class="c1">// if any input changes, recompute the sum.</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">onInputsUpdated</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">outputs</span><span class="p">.</span><span class="nx">sum</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">inputs</span><span class="p">.</span><span class="nx">augend</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">inputs</span><span class="p">.</span><span class="nx">addend</span><span class="p">;</span>
  <span class="p">};</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="context">Context</h3>

<p>Every component has a <code class="highlighter-rouge">context</code> property implicitly defined for it. The <code class="highlighter-rouge">context</code> contains access to</p>
<ul>
  <li><code class="highlighter-rouge">root</code>, the node the component is attached to</li>
  <li><code class="highlighter-rouge">three</code>, the currently loaded THREE.js script from Showcase</li>
  <li><code class="highlighter-rouge">renderer</code>, Showcase’s active <code class="highlighter-rouge">THREE.WebGLRenderer</code></li>
</ul>

<div class="alert alert-info" role="alert"><i class="fa fa-info-circle"></i> <b>Note:</b> Any webgl objects, including <code class="highlighter-rouge">Material</code> or <code class="highlighter-rouge">Geometry</code>, MUST be created using <code class="highlighter-rouge">THREE.js</code> provided by <code class="highlighter-rouge">context.three</code> because of THREE.js’s internal id system used to uniquely identify objects.</div>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nx">Renderable</span> <span class="p">{</span>
  <span class="nx">onInit</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">THREE</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">three</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">outputs</span><span class="p">.</span><span class="nx">objectRoot</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Mesh</span><span class="p">(</span>
      <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">BoxBufferGeometry</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="p">),</span>
      <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">MeshBasicMaterial</span><span class="p">(</span> <span class="p">{</span> <span class="na">color</span><span class="p">:</span> <span class="mh">0xffff00</span> <span class="p">}</span> <span class="p">));</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="emits-and-event-subscriptions">Emits and Event Subscriptions</h3>

<p>Components also have properties named <code class="highlighter-rouge">events</code> and <code class="highlighter-rouge">emits</code>, and a function <code class="highlighter-rouge">notify</code>.</p>

<p>The <code class="highlighter-rouge">events</code> dictionary defines which type of events the component subscribes to. The keys of the dictionary define the event types. The values determine if the component receives those events – truthy values mean the component will, falsy values mean it won’t. Event subscriptions can be changed at will at any time.</p>

<p>The <code class="highlighter-rouge">emits</code> dictionary defines which events the component can emit through a call to its <code class="highlighter-rouge">notify</code> function. If the value of an event in <code class="highlighter-rouge">emits</code> is falsy, then it will not <code class="highlighter-rouge">notify</code> other components of that event. Otherwise, each call to <code class="highlighter-rouge">notify</code> triggers a call to <code class="highlighter-rouge">onEvent</code> of the component bound to it on the next iteration through the component lifecycle.</p>

<p>Receiving user input from the mouse or touch is possible using built-in event types like: <code class="highlighter-rouge">INTERACTION.HOVER</code>, <code class="highlighter-rouge">INTERACTION.CLICK</code>, <code class="highlighter-rouge">INTERACTION.DRAG</code>. For all supported input events, see <a href="docs/sdkbundle/reference/current/enums/scene.interactiontype.html">InteractionType</a></p>
<div class="alert alert-info" role="alert"><i class="fa fa-info-circle"></i> <b>Note:</b> a component will only receive input if they also set their <code class="highlighter-rouge">collider</code> output.</div>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nx">Clickable</span> <span class="p">{</span>
  <span class="nx">events</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1">// subscribe to click events</span>
    <span class="p">[</span><span class="nx">ComponentInteractionType</span><span class="p">.</span><span class="nx">CLICK</span><span class="p">]:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="p">}</span>

  <span class="nx">emits</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1">// emit a clicked events</span>
    <span class="na">clicked</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>

  <span class="p">};</span>

  <span class="nx">onInit</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">THREE</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">three</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">outputs</span><span class="p">.</span><span class="nx">collider</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Mesh</span><span class="p">();</span>
  <span class="p">}</span>

  <span class="nx">onEvent</span><span class="p">(</span><span class="nx">eventType</span><span class="p">:</span> <span class="nx">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">eventType</span> <span class="o">===</span> <span class="nx">ComponentInteractionType</span><span class="p">.</span><span class="nx">CLICK</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Clickable component was clicked!'</span><span class="p">);</span>
      <span class="c1">// cancel the click event subscription, this component will no longer receive clicks</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">events</span><span class="p">[</span><span class="nx">ComponentInteractionType</span><span class="p">.</span><span class="nx">CLICK</span><span class="p">]</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>

      <span class="c1">// tell other components that this component was clicked</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">notify</span><span class="p">(</span><span class="s1">'clicked'</span><span class="p">,</span> <span class="p">{</span> <span class="cm">/* an optional payload */</span><span class="p">});</span>

      <span class="c1">// disable the 'clicked' emit</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">emits</span><span class="p">.</span><span class="nx">clicked</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
      <span class="c1">// this will NOT notify other components since `emits.clicked` was set to `false`</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">notify</span><span class="p">(</span><span class="s1">'clicked'</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="paths">Paths</h2>

<p>Paths create references to a property of a component’s inputs, outputs, events, or emits.</p>

<p>Paths are the primary mechanism used to connect two components together and to setup spies (more on spies in the next section).
They can also be used to set values on inputs, and read values from outputs.</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">interface</span> <span class="nx">InputPath</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span> <span class="p">{</span>
  <span class="kd">get</span><span class="p">():</span> <span class="nx">T</span><span class="p">;</span>
  <span class="kd">set</span><span class="p">(</span><span class="na">newVal</span><span class="p">:</span> <span class="nx">T</span><span class="p">):</span> <span class="k">void</span><span class="p">;</span>
<span class="p">}</span>

<span class="kr">interface</span> <span class="nx">OutputPath</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span> <span class="p">{</span>
  <span class="kd">get</span><span class="p">():</span> <span class="nx">T</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="creating-a-path">Creating a Path</h3>

<p>Paths are created through a scene object that they will be associated with.</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Create a scene object, node, and component</span>
<span class="kd">const</span> <span class="p">[</span><span class="nx">sceneObject</span><span class="p">]</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">sdk</span><span class="p">.</span><span class="nx">Scene</span><span class="p">.</span><span class="nx">createObjects</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">node</span> <span class="o">=</span> <span class="nx">sceneObject</span><span class="p">.</span><span class="nx">addNode</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">component</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">addComponent</span><span class="p">(</span><span class="s1">'sum'</span><span class="p">);</span>

<span class="c1">// create and add a path that references the component's output</span>
<span class="kd">const</span> <span class="nx">sumOutputPath</span> <span class="o">=</span> <span class="nx">sceneObject</span><span class="p">.</span><span class="nx">addPath</span><span class="p">({</span>
  <span class="na">id</span><span class="p">:</span> <span class="s1">'my-output-path'</span><span class="p">,</span>
  <span class="na">type</span><span class="p">:</span> <span class="nx">sdk</span><span class="p">.</span><span class="nx">Scene</span><span class="p">.</span><span class="nx">PathType</span><span class="p">.</span><span class="nx">OUTPUT</span><span class="p">,</span>
  <span class="nx">node</span><span class="p">,</span>
  <span class="nx">component</span><span class="p">,</span>
  <span class="na">property</span><span class="p">:</span> <span class="s1">'sum'</span>
<span class="p">});</span>
</code></pre></div></div>

<h3 id="binding-properties-using-paths">Binding Properties using Paths</h3>

<p>A property binding is a connection from a component’s <code class="highlighter-rouge">inputs</code> property to another component’s <code class="highlighter-rouge">outputs</code> property. The <code class="highlighter-rouge">inputs</code> property is called the <strong>Binding Target</strong> and the <code class="highlighter-rouge">outputs</code> property is called the <strong>Binding Source</strong>. Changes to the <strong>Binding Source</strong> value will propagate to the <strong>Binding Target</strong>.  <strong>Binding Targets</strong> should be treated as <code class="highlighter-rouge">read-only</code>.</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// some helper function to generate paths</span>
<span class="kd">function</span> <span class="nx">createOutputPath</span><span class="p">(</span><span class="nx">id</span><span class="p">:</span> <span class="nx">string</span><span class="p">,</span> <span class="nx">component</span><span class="p">:</span> <span class="nx">sdk</span><span class="p">.</span><span class="nx">Scene</span><span class="p">.</span><span class="nx">IComponent</span><span class="p">,</span> <span class="nx">property</span><span class="p">:</span> <span class="nx">string</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">sceneObject</span><span class="p">.</span><span class="nx">addPath</span><span class="p">({</span>
    <span class="nx">id</span><span class="p">,</span>
    <span class="na">type</span><span class="p">:</span> <span class="nx">sdk</span><span class="p">.</span><span class="nx">Scene</span><span class="p">.</span><span class="nx">PathType</span><span class="p">.</span><span class="nx">OUTPUT</span><span class="p">,</span>
    <span class="nx">node</span><span class="p">,</span>
    <span class="nx">component</span><span class="p">,</span>
    <span class="nx">property</span><span class="p">,</span>
  <span class="p">});</span>
<span class="p">}</span>
<span class="kd">function</span> <span class="nx">createInputPath</span><span class="p">(</span><span class="nx">id</span><span class="p">:</span> <span class="nx">string</span><span class="p">,</span> <span class="nx">component</span><span class="p">:</span> <span class="nx">sdk</span><span class="p">.</span><span class="nx">Scene</span><span class="p">.</span><span class="nx">IComponent</span><span class="p">,</span> <span class="nx">property</span><span class="p">:</span> <span class="nx">string</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">sceneObject</span><span class="p">.</span><span class="nx">addPath</span><span class="p">({</span>
    <span class="nx">id</span><span class="p">,</span>
    <span class="na">type</span><span class="p">:</span> <span class="nx">sdk</span><span class="p">.</span><span class="nx">Scene</span><span class="p">.</span><span class="nx">PathType</span><span class="p">.</span><span class="nx">INPUT</span><span class="p">,</span>
    <span class="nx">node</span><span class="p">,</span>
    <span class="nx">component</span><span class="p">,</span>
    <span class="nx">property</span><span class="p">,</span>
  <span class="p">});</span>
<span class="p">}</span>
<span class="c1">// assume Sum() class from Inputs and Outputs Dictionaries section</span>
<span class="kd">const</span> <span class="p">[</span><span class="nx">sceneObject</span><span class="p">]</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">sdk</span><span class="p">.</span><span class="nx">Scene</span><span class="p">.</span><span class="nx">createObjects</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">node</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">sceneObject</span><span class="p">.</span><span class="nx">addNode</span><span class="p">();</span>
<span class="kd">var</span> <span class="nx">comp1</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">addComponent</span><span class="p">(</span><span class="s1">'sum'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">comp2</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">addComponent</span><span class="p">(</span><span class="s1">'sum'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">comp3</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">addComponent</span><span class="p">(</span><span class="s1">'sum'</span><span class="p">);</span>

<span class="c1">// create a path to comp1.inputs.augend</span>
<span class="kd">const</span> <span class="nx">comp1Augend</span> <span class="o">=</span> <span class="nx">createInputPath</span><span class="p">(</span><span class="s1">'comp1-augend'</span><span class="p">,</span> <span class="nx">comp1</span><span class="p">,</span> <span class="s1">'augend'</span><span class="p">);</span>
<span class="c1">// create a path to comp1.inputs.addend</span>
<span class="kd">const</span> <span class="nx">comp1Addend</span> <span class="o">=</span> <span class="nx">createInputPath</span><span class="p">(</span><span class="s1">'comp1-addend'</span><span class="p">,</span> <span class="nx">comp1</span><span class="p">,</span> <span class="s1">'addend'</span><span class="p">)</span>
<span class="c1">// create a path to comp2.outputs.sum</span>
<span class="kd">const</span> <span class="nx">comp2Sum</span> <span class="o">=</span> <span class="nx">createOutputPath</span><span class="p">(</span><span class="s1">'comp2-sum'</span><span class="p">,</span> <span class="nx">comp2</span><span class="p">,</span> <span class="s1">'sum'</span><span class="p">);</span>
<span class="c1">// create a path to comp3.outputs.sum</span>
<span class="kd">const</span> <span class="nx">comp3Sum</span> <span class="o">=</span> <span class="nx">createOutputPath</span><span class="p">(</span><span class="s1">'comp3-sum'</span><span class="p">,</span> <span class="nx">comp3</span><span class="p">,</span> <span class="s1">'sum'</span><span class="p">);</span>

<span class="c1">// bind the the output (sum) of comp2 to the input (augend) of comp1</span>
<span class="nx">sceneObject</span><span class="p">.</span><span class="nx">bindPath</span><span class="p">(</span><span class="nx">comp1Augend</span><span class="p">,</span> <span class="nx">comp2Sum</span><span class="p">);</span>
<span class="c1">// bind the the output (sum) of comp3 to the input (addend) of comp1</span>
<span class="nx">sceneObject</span><span class="p">.</span><span class="nx">bindPath</span><span class="p">(</span><span class="nx">comp1Addend</span><span class="p">,</span> <span class="nx">comp3Sum</span><span class="p">);</span>

<span class="nx">node</span><span class="p">.</span><span class="nx">start</span><span class="p">();</span>

<span class="c1">// start modifying comp2's and comp3's inputs to automatically modify comp1's sum</span>
<span class="nx">comp2</span><span class="p">.</span><span class="nx">inputs</span><span class="p">.</span><span class="nx">augend</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">comp1</span><span class="p">.</span><span class="nx">outputs</span><span class="p">.</span><span class="nx">sum</span><span class="p">);</span>
<span class="c1">// output: 5</span>

<span class="nx">comp3</span><span class="p">.</span><span class="nx">inputs</span><span class="p">.</span><span class="nx">addend</span> <span class="o">=</span> <span class="mi">6</span><span class="p">;</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">comp1</span><span class="p">.</span><span class="nx">outputs</span><span class="p">.</span><span class="nx">sum</span><span class="p">);</span>
<span class="c1">// output: 11</span>

</code></pre></div></div>
<div class="mermaid">
graph LR&#10;
  a13 --&gt; a00["11"]&#10;
  a01["5"] --&gt; a21&#10;
  a04["6"] --&gt; a32&#10;
  subgraph comp1&#10;
    a11[augend] --&gt; a13[sum]&#10;
    a12[addend] --&gt; a13[sum]&#10;
    linkStyle 3 stroke-width:0px&#10;
    linkStyle 4 stroke-width:0px&#10;
  end&#10;
  subgraph comp2&#10;
    a21[augend] --&gt; a23[sum]&#10;
    a22[addend] --&gt; a23[sum]&#10;
    a23[sum] --&gt; |5| a11&#10;
    linkStyle 5 stroke-width:0px&#10;
    linkStyle 6 stroke-width:0px&#10;
  end&#10;
  subgraph comp3&#10;
    a31[augend] --&gt; a33[sum]&#10;
    a32[addend] --&gt; a33[sum]&#10;
    a33[sum] --&gt; |6| a12&#10;
    linkStyle 8 stroke-width:0px&#10;
    linkStyle 9 stroke-width:0px&#10;
  end&#10;
</div>

<h3 id="event-bindings">Event Bindings</h3>

<p>An event binding is an alternative means of connecting two components. A component can notify other components an event has occurred by calling its <code class="highlighter-rouge">notify</code> function. The components that broadcast events are called <strong>Event Sources</strong> and components that recieve events are called <strong>Event Sinks</strong>.
A source’s event name doesn’t have to match the sink’s name. The binding will map between the two. Event Bindings are implemented this way in order to facilitate the creation of components that are more reusable, easily swappable, and more decoupled.</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nx">Clickable</span> <span class="p">{</span>
  <span class="nx">emits</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">clicked</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="p">};</span>
  <span class="c1">// ...</span>
  <span class="nx">onEvent</span><span class="p">(</span><span class="nx">eventType</span><span class="p">:</span> <span class="nx">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">notify</span><span class="p">(</span><span class="s1">'clicked'</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>
<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nx">Random</span> <span class="p">{</span>
  <span class="nx">events</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">randomize</span><span class="p">:</span> <span class="kc">true</span>
  <span class="p">}</span>

  <span class="nx">outputs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">num</span><span class="p">:</span> <span class="mi">0</span>
  <span class="p">}</span>

  <span class="nx">onEvent</span><span class="p">(</span><span class="nx">eventType</span><span class="p">:</span> <span class="nx">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">eventType</span> <span class="o">===</span> <span class="s1">'randomize'</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">outputs</span><span class="p">.</span><span class="nx">num</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">();</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>
<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// assume the previous two components have been registered</span>
<span class="kd">const</span> <span class="p">[</span><span class="nx">sceneObject</span><span class="p">]</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">sdk</span><span class="p">.</span><span class="nx">Scene</span><span class="p">.</span><span class="nx">createObjects</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">node</span> <span class="o">=</span> <span class="nx">sceneObject</span><span class="p">.</span><span class="nx">createNode</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">clickable</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">addComponent</span><span class="p">(</span><span class="s1">'clickable'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">random</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">addComponent</span><span class="p">(</span><span class="s1">'random'</span><span class="p">);</span>

<span class="c1">// bind Random's 'randomize' event to Clickable's 'clicked' event</span>
<span class="kd">const</span> <span class="nx">emitPath</span> <span class="o">=</span> <span class="nx">scenObject</span><span class="p">.</span><span class="nx">addPath</span><span class="p">({</span>
  <span class="na">id</span><span class="p">:</span> <span class="s1">'emit-clicked'</span><span class="p">,</span>
  <span class="na">type</span><span class="p">:</span> <span class="nx">sdk</span><span class="p">.</span><span class="nx">Scene</span><span class="p">.</span><span class="nx">PathType</span><span class="p">.</span><span class="nx">EMIT</span><span class="p">,</span>
  <span class="nx">node</span><span class="p">,</span>
  <span class="na">component</span><span class="p">:</span> <span class="nx">clickable</span><span class="p">,</span>
  <span class="na">property</span><span class="p">:</span> <span class="s1">'clicked'</span><span class="p">,</span>
<span class="p">});</span>

<span class="kd">const</span> <span class="nx">eventPath</span> <span class="o">=</span> <span class="nx">sceneObject</span><span class="p">.</span><span class="nx">addPath</span><span class="p">({</span>
  <span class="na">id</span><span class="p">:</span> <span class="s1">'event-randomize'</span><span class="p">,</span>
  <span class="na">type</span><span class="p">:</span> <span class="nx">sdk</span><span class="p">.</span><span class="nx">Scene</span><span class="p">.</span><span class="nx">PathType</span><span class="p">.</span><span class="nx">EVENT</span><span class="p">,</span>
  <span class="nx">node</span><span class="p">,</span>
  <span class="na">component</span><span class="p">:</span> <span class="nx">random</span><span class="p">,</span>
  <span class="na">property</span><span class="p">:</span> <span class="s1">'randomize'</span><span class="p">,</span>
<span class="p">});</span>

<span class="nx">sceneObject</span><span class="p">.</span><span class="nx">bindPath</span><span class="p">(</span><span class="nx">eventPath</span><span class="p">,</span> <span class="nx">emitPath</span><span class="p">);</span>

<span class="c1">// from now on when `clickable` is clicked, `random` updates its `output.num` value</span>
</code></pre></div></div>
<div class="mermaid">
graph LR
  notify --clicked--&gt; map
  map --randomize--&gt; onEvent
  subgraph Source
    notify
  end
  subgraph Event Binding
    map[event mapping]
  end
  subgraph Sink
    onEvent
  end
  style map stroke-dasharray: 5, 5
</div>

<h2 id="spies">Spies</h2>

<p>Spies create ways to receive callbacks when a component’s inputs or outputs change, or when it calls <code class="highlighter-rouge">notify</code> to emit an event.
Spies work outside of Matterport’s component system so it is a way to bridge to other frameworks.</p>

<p>Calling <code class="highlighter-rouge">spyOnEvent</code> on a scene object will attach a spy to the path it is associated with. <code class="highlighter-rouge">spyOnEvent</code> returns an <code class="highlighter-rouge">ISubscription</code> which is used to remove the spy by calling its <code class="highlighter-rouge">cancel</code> function.</p>

<h3 id="spying-on-emits">Spying on Emits</h3>

<p>It is possible to spy on components’ events from outside of a component. A spy can listen for an emit with a specific eventType and will have its <code class="highlighter-rouge">onEvent</code> function called when the component it is attached to calls its <code class="highlighter-rouge">notify</code> function with that eventType.</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// assume Clickable class from "Event Subscriptions" section</span>
<span class="kd">const</span> <span class="p">[</span><span class="nx">sceneObject</span><span class="p">]</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">sdk</span><span class="p">.</span><span class="nx">Scene</span><span class="p">.</span><span class="nx">createObjects</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">node</span> <span class="o">=</span> <span class="nx">sceneObject</span><span class="p">.</span><span class="nx">addNode</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">clickComponent</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">addComponent</span><span class="p">(</span><span class="s1">'clickable'</span><span class="p">);</span>

<span class="kd">class</span> <span class="nx">ClickSpy</span> <span class="kr">implements</span> <span class="nx">MpSdk</span><span class="p">.</span><span class="nx">Scene</span><span class="p">.</span><span class="nx">ISceneObjectSpy</span><span class="o">&lt;</span><span class="nx">Intersect</span><span class="o">&gt;</span> <span class="p">{</span>
  <span class="nx">readonly</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">clickPath</span><span class="p">;</span>
  <span class="nx">onEvent</span><span class="p">(</span><span class="nx">type</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'spied a notify. Event type:'</span><span class="p">,</span> <span class="nx">type</span><span class="p">,</span> <span class="s1">'w/ data'</span><span class="p">,</span> <span class="nx">data</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">const</span> <span class="nx">clickPath</span> <span class="o">=</span> <span class="nx">sceneObject</span><span class="p">.</span><span class="nx">addPath</span><span class="p">({</span>
  <span class="na">id</span><span class="p">:</span> <span class="s1">'emit-click'</span><span class="p">,</span>
  <span class="na">type</span><span class="p">:</span> <span class="nx">sdk</span><span class="p">.</span><span class="nx">Scene</span><span class="p">.</span><span class="nx">PathType</span><span class="p">.</span><span class="nx">EMIT</span><span class="p">,</span>
  <span class="nx">node</span><span class="p">,</span>
  <span class="na">component</span><span class="p">:</span> <span class="nx">clickComponent</span><span class="p">,</span>
  <span class="na">property</span><span class="p">:</span> <span class="s1">'clicked'</span><span class="p">,</span>
<span class="p">});</span>

<span class="c1">// attach spies</span>
<span class="kd">const</span> <span class="nx">clickSubscription</span> <span class="o">=</span> <span class="nx">sceneObject</span><span class="p">.</span><span class="nx">spyOnEvent</span><span class="p">(</span><span class="nx">clickPath</span><span class="p">);</span>

<span class="nx">node</span><span class="p">.</span><span class="nx">start</span><span class="p">();</span>

<span class="c1">// from here, any time the Clickable component calls `notify('clicked')`, `ClickSpy.onEvent` will be called</span>

<span class="c1">// stop spying on the click events</span>
<span class="nx">clickSubscription</span><span class="p">.</span><span class="nx">cancel</span><span class="p">();</span>
</code></pre></div></div>
<div class="mermaid">
graph LR
  notify --INTERACTION.CLICK--&gt; handler
  subgraph Clickable
    notify
  end
  subgraph Click Spy
    handler[onEvent]
  end
</div>

<h3 id="spying-on-inputs-and-outputs">Spying on Inputs and Outputs</h3>

<p>It is also possible to spy on inputs and outputs and watch them for changes.
The <code class="highlighter-rouge">type</code> in the callback will either be <code class="highlighter-rouge">'inputsUpdated'</code> or <code class="highlighter-rouge">'outputsUpdated'</code> depending on which property the spy is attached to.</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// assume Sum class from "Input and Output Dictionaries" section</span>
<span class="kd">const</span> <span class="p">[</span><span class="nx">sceneObject</span><span class="p">]</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">sdk</span><span class="p">.</span><span class="nx">Scene</span><span class="p">.</span><span class="nx">createObjects</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">node</span> <span class="o">=</span> <span class="nx">sceneObject</span><span class="p">.</span><span class="nx">addNode</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">sumComponent</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">addComponent</span><span class="p">(</span><span class="s1">'sum'</span><span class="p">);</span>

<span class="kd">class</span> <span class="nx">SumSpy</span> <span class="kr">implements</span> <span class="nx">MpSdk</span><span class="p">.</span><span class="nx">Scene</span><span class="p">.</span><span class="nx">ISceneObjectSpy</span> <span class="p">{</span>
  <span class="nx">readonly</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">sumPath</span><span class="p">;</span>
  <span class="nx">onEvent</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'spied a change to outputs.sum. New sum:'</span><span class="p">,</span> <span class="nx">data</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nx">AddendSpy</span> <span class="kr">implements</span> <span class="nx">MpSdk</span><span class="p">.</span><span class="nx">Scene</span><span class="p">.</span><span class="nx">ISceneObjectSpy</span> <span class="p">{</span>
  <span class="nx">readonly</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">addendPath</span><span class="p">;</span>
  <span class="nx">onEvent</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'spied change to inputs.addend. New addend value:'</span><span class="p">,</span> <span class="nx">data</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// create the output path</span>
<span class="kd">const</span> <span class="nx">sumPath</span> <span class="o">=</span> <span class="nx">sceneObject</span><span class="p">.</span><span class="nx">addPath</span><span class="p">({</span>
  <span class="na">id</span><span class="p">:</span> <span class="s1">'sum-output'</span><span class="p">,</span>
  <span class="na">type</span><span class="p">:</span> <span class="nx">sdk</span><span class="p">.</span><span class="nx">Scene</span><span class="p">.</span><span class="nx">PathType</span><span class="p">.</span><span class="nx">OUTPUT</span><span class="p">,</span>
  <span class="nx">node</span><span class="p">,</span>
  <span class="na">component</span><span class="p">:</span> <span class="nx">sumComponent</span><span class="p">,</span>
  <span class="na">property</span><span class="p">:</span> <span class="s1">'sum'</span><span class="p">,</span>
<span class="p">});</span>
<span class="c1">// create the input path</span>
<span class="kd">const</span> <span class="nx">addendPath</span> <span class="o">=</span> <span class="nx">sceneObject</span><span class="p">.</span><span class="nx">addPath</span><span class="p">({</span>
  <span class="na">id</span><span class="p">:</span> <span class="s1">'addend-input'</span><span class="p">,</span>
  <span class="na">type</span><span class="p">:</span> <span class="nx">sdk</span><span class="p">.</span><span class="nx">Scene</span><span class="p">.</span><span class="nx">PathType</span><span class="p">.</span><span class="nx">INPUT</span><span class="p">,</span>
  <span class="nx">node</span><span class="p">,</span>
  <span class="na">component</span><span class="p">:</span> <span class="nx">sumComponent</span><span class="p">,</span>
  <span class="na">property</span><span class="p">:</span> <span class="s1">'addend'</span><span class="p">,</span>
<span class="p">});</span>

<span class="c1">// attach spies</span>
<span class="kd">const</span> <span class="nx">sumSubscription</span> <span class="o">=</span> <span class="nx">constsceneObject</span><span class="p">.</span><span class="nx">spyOnEvent</span><span class="p">(</span><span class="k">new</span> <span class="nx">SumSpy</span><span class="p">());</span>
<span class="kd">const</span> <span class="nx">addendSubscription</span> <span class="o">=</span> <span class="nx">sceneObject</span><span class="p">.</span><span class="nx">spyOnEvent</span><span class="p">(</span><span class="k">new</span> <span class="nx">AddendSpy</span><span class="p">());</span>

<span class="nx">node</span><span class="p">.</span><span class="nx">start</span><span class="p">();</span>

<span class="c1">// making a change to the "Sum" component's `inputs.augend` will recompute its `output.sum` which will trigger the SumSpy's `onEvent` with the new sum value</span>
<span class="nx">sumComponent</span><span class="p">.</span><span class="nx">inputs</span><span class="p">.</span><span class="nx">augend</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

<span class="c1">// making an input change is possible through paths</span>
<span class="nx">addendPath</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span> <span class="c1">// will trigger the AddendSpy's `onEvent`</span>

<span class="c1">// after the Sum component updates its `outputs.sum`</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">sumPath</span><span class="p">.</span><span class="kd">get</span><span class="p">());</span> <span class="c1">// will have a value of 5 (augend: 1 + addend: 4)</span>

<span class="c1">// stop spying on the input changes</span>
<span class="nx">addendSubscription</span><span class="p">.</span><span class="nx">cancel</span><span class="p">();</span>

<span class="c1">// stop spying on the output changes</span>
<span class="nx">sumSubscription</span><span class="p">.</span><span class="nx">cancel</span><span class="p">();</span>
</code></pre></div></div>


    <div class="tags">
        
    </div>

<!-- 
 -->

</div>

<!-- <hr class="shaded"/> -->

<footer>
            <div class="row">
                <div class="col-lg-12 footer">
               &copy;2022 Matterport, Inc. All rights reserved. <br />
 Site last generated: Mar 11, 2022 <br />
<p><img class="footer-logo" src="images/MP-logo_icon-RGB_black.svg" alt="Company logo"/></p>
                </div>
            </div>
</footer>


        </div>
    <!-- /.row -->
</div>
<!-- /.container -->
</div>
<!-- /#main -->
    </div>


</body>

<!-- the google_analytics_id gets auto inserted from the config file -->



<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-34880260-5','auto');ga('require','displayfeatures');ga('send','pageview');</script>


</html>
